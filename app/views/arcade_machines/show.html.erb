<!--
  ARCADE MACHINE DETAIL VIEW
-->

<%= render "shared/detail_header", image: @arcade_machine.cover_image.url, title: @arcade_machine.title, description: @arcade_machine.description %>

<div class="arcade-machine detail">

  <div class="row">



    <!-- Metadata -->

    <div class="col-md-6">

      <!-- Game Description -->
      <div class="detail-description">
        <%= simple_format(@arcade_machine.description) %>

        <!-- Edit Buttons -->
        <div class="detail-edit-buttons">
          <%= render "edit_buttons", arcade_machine: @arcade_machine %>
        </div>
      </div>

      <% if user_signed_in? && (current_user.owns?(@arcade_machine) || current_user.admin?) %>
        <div class="api-key">
          <h4>API Key</h4>
          <code>
            <%= @arcade_machine.api_keys.first.token %>
          </code>
        </div>
      <% end %>

      <hr />

      <h4>Location</h4>
      <p><%= @arcade_machine.location %></p>

      <h4>Images</h4>
      <%= render "images/list", imageable: @arcade_machine %>


      <h4>
        <%= @arcade_machine.users.size > 1 ? "Owners" : "Owner" %>
      </h4>

      <div class="clearfix">
        <% @arcade_machine.users.each do |user| %>
          <%= render "shared/item_cards_square",
            itemName: user.name,
            itemInfo: "",
            itemLink: user_url(user),
            itemImageURL: user.gravatar_url
          %>
        <% end %>
      </div>

    </div>





    <!-- Game Data -->

    <div class="col-md-6">

      <h4>Subscribed to these playlists:</h4>
      <% if @arcade_machine.playlists.any? %>
      <% @arcade_machine.playlists.each do |playlist| %>
        <% subscription = Subscription.find_by(playlist: playlist, arcade_machine: @arcade_machine) %>
        <%= render "shared/item_cards_small",
          itemName: playlist.title,
          itemInfo: link_to("unsubscribe", subscription_path(subscription), method: :delete),
          itemLink: playlist_url(playlist),
          itemImageURL: playlist.cover_image.url
        %>
      <% end %>
      <% else %>
        <h5>
          No playlists yet.
          <br/>
          Be the first to add a playlist!
        </h5>
      <% end %>




  </div>

</div>
