<!--
  ARCADE MACHINE DETAIL VIEW
-->

<%= render "shared/detail_header", image: @arcade_machine.cover_image.url(w: 980), title: @arcade_machine.title, description: @arcade_machine.description %>

<div class="arcade-machine detail">

  <div class="row">

    <!-- Metadata -->

    <div class="col-md-6">

      <!-- Game Description -->
      <div class="detail-description">
        <%= simple_format(@arcade_machine.description) %>

        <!-- Edit Buttons -->
        <div class="detail-edit-buttons">
          <%= render "edit_buttons", arcade_machine: @arcade_machine %>
        </div>
      </div>

      <% if user_signed_in? && (current_user.owns?(@arcade_machine) || current_user.admin?) %>
        <div class="col-md-12">
          <h4>API Key</h4>
          <code>
            <%= @arcade_machine.api_keys.first.token %>
          </code>
        </div>
      <% end %>

      <hr />

      <div class="col-md-12">
        <h4>Location</h4>
        <p><%= @arcade_machine.location %></p>
      </div>

      <% if @arcade_machine.images.any? %>
        <div class="col-md-12">
          <h4>Images</h4>
          <%= render "images/list", imageable: @arcade_machine %>
        </div>
      <% end %>


      <div class="col-md-12">
        <h4>
          <%= @arcade_machine.users.size > 1 ? "Owners" : "Owner" %>
        </h4>

        <% @arcade_machine.users.each do |user| %>
          <%= render "shared/item_cards_square",
            item_name: user.name,
            item_info: "",
            item_link: user_url(user),
            item_image_url: user.gravatar_url
          %>
        <% end %>
      </div>

      <div class="clearfix"></div>

    </div>





    <!-- Game Data -->

    <div class="col-md-6">

      <h4>Subscribed to these playlists:</h4>
      <% if @arcade_machine.playlists.any? %>
      <% @arcade_machine.playlists.each do |playlist| %>
        <% subscription = Subscription.find_by(playlist: playlist, arcade_machine: @arcade_machine) %>
        <%=
          render "shared/item_cards_small", item: playlist,
                                            info: link_to("unsubscribe", subscription_path(subscription), method: :delete)
        %>
      <% end %>
      <% else %>
        <h5>
          No playlists yet.
          <br/>
          Be the first to add a playlist!
        </h5>
      <% end %>




  </div>

</div>
